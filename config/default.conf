server {
	listen 8080;
	root www/;

	max_size 10M;

	# global upload directory for your POST handler
	upload www/upload;

	# error_page 404 /errors/404.gif;
	error_page 403 /errors/403.gif;
	error_page 405 /pages/errors/405.html;


# Comment out the below to demonstrate auto-generated error pages
	error_page 413 /errors/413.html;

	# ----------------------------
	# HOME
	# ----------------------------
	location / {
		methods GET;
		index pages/index.html;
	}

	# ----------------------------
	# PAGES (served as static files)
	# Use /pages/... for upload page so it never conflicts with /upload uploads.
	# ----------------------------
	location /pages {
		methods GET;
		root www/pages/;
	}

	# Optional convenience routes
	location /test {
		methods GET;
		index pages/test.html;
	}

	# ----------------------------
	# ASSETS
	# ----------------------------
	location /assets {
		methods GET;
		root www/assets/;
	}

	# ----------------------------
	# TESTS
	# ----------------------------
	location /tests/static {
		methods GET;
		root www/tests/static/;
	}

	location /tests/autoindex {
		methods GET;
		root www/tests/autoindex/;
		autoindex on;
	}

	# If you add permtest under www/tests/permtest/
	location /tests/permtest {
		methods GET;
		root www/tests/permtest/;
		autoindex on;
	}

	# ----------------------------
	# UPLOAD ENDPOINT (FILES)
	# IMPORTANT: this must be /upload (NOT /upload page)
	# so that /upload/<filename> matches here and allows POST/DELETE.
	# ----------------------------
	location /upload {
		methods GET POST DELETE;
		root www/upload/;
		upload www/upload;
		max_size 1M;

		# So GET /upload/ doesn't 403 during evaluation
		autoindex on;
	}

	# ----------------------------
	# SIZE LIMIT TEST
	# ----------------------------
	location /no_size {
		methods POST GET;
		max_size 0K;
	}

	# ----------------------------
	# REDIRECT TEST
	# ----------------------------
	location /search {
		return 301 https://www.google.com/;
	}

	# ----------------------------
	# CGI-BIN
	# ----------------------------
	location /cgi-bin {
		root cgi-bin/;
		cgi_extension .py;
		methods GET POST;
	}

	# ----------------------------
	# FAVICON
	# ----------------------------
	location /favicon.ico {
		root www/assets/img/favicon.ico;
	}

	# ----------------------------
	# CSS
	# ----------------------------
	location /css {
		root www/assets/css/;
	}
}

# Optional 2nd server like your old config (remove if you donâ€™t need it)
server {
	listen 8181;
	root www2/;

	location / {
		methods GET;
		index index.html;
	}

	location /favicon {
		index favicon.ico;
	}
}
